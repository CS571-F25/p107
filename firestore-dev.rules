rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // DEVELOPMENT RULES - 临时开发规则
    // 生产环境需要更严格的规则
    
    // 角色集合 - 认证用户可读写（用于系统初始化）
    match /roles/{roleId} {
      allow read, write: if request.auth != null;
    }
    
    // 用户角色集合 - 认证用户可读写（用于系统初始化）
    match /userRoles/{userRoleId} {
      allow read, write: if request.auth != null;
    }
    
    // 博客文章集合
    match /posts/{postId} {
      // 已发布的文章任何人都可以读取
      allow read: if resource.data.status == 'published' || 
                     resource.data.isPublished == true ||
                     request.auth != null;
      
      // 认证用户可以创建和修改文章
      allow create, update, delete: if request.auth != null;
    }
    
    // 点赞集合
    match /likes/{likeId} {
      allow read: if true; // 任何人都可以读取点赞数
      allow create, update, delete: if request.auth != null;
    }
    
    // 审计日志
    match /auditLogs/{logId} {
      allow read, write: if request.auth != null;
    }
  }
}