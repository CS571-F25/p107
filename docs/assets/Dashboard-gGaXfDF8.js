import{j as e,b as te,R as P,c as u,a as o,A as $,C,F as v,g as ae,h as le,D as i,P as w,M as m,B as ne}from"./vendor-bootstrap-D2eqalZl.js";import{u as ie,r as l}from"./vendor-router-CUyV5JBb.js";import{j as re,T as ce,u as de,g as oe,P as c,k as O,i as V,p as _}from"./blog-BQPs9klV.js";import"./vendor-firebase-CYcY3q11.js";import"./auth-DdQ2LLef.js";import"./vendor-react-Bzgz95E1.js";function he(){const g=ie(),[S,G]=l.useState([]),[W,F]=l.useState(!0),[L,x]=l.useState(""),[d,q]=l.useState("all"),[h,J]=l.useState("all"),[n,f]=l.useState([]),[K,p]=l.useState(!1),[D,U]=l.useState(null),[k,E]=l.useState(!1),[j,N]=l.useState(1),[A]=l.useState(10),[ue,xe]=l.useState(!1),{theme:Q}=l.useContext(ce);de();const I=Q==="dark";l.useEffect(()=>{b()},[d,h,j]);const b=async()=>{try{F(!0);const t=await oe(100,{status:d==="all"?"all":d==="published"?"published-only":d==="draft"?"drafts-only":"all"});let a=t;h!=="all"&&(a=t.filter(r=>r.authorId===h||r.author&&r.author.toLowerCase().includes(h.toLowerCase()))),d!=="all"&&(a=a.filter(r=>r.status===d)),G(a)}catch(s){x(s.message||"Failed to load posts")}finally{F(!1)}},M=async(s,t)=>{try{t===c.PUBLISHED?await _(s):t===c.DRAFT&&await V(s),await b()}catch(a){x(a.message||"Failed to update post status")}},X=async s=>{try{await O(s),p(!1),U(null),await b()}catch(t){x(t.message||"Failed to delete post")}},B=async s=>{if(n.length!==0)try{switch(E(!0),s){case"publish":await Promise.all(n.map(t=>_(t)));break;case"unpublish":await Promise.all(n.map(t=>V(t)));break;case"delete":window.confirm(`Delete ${n.length} posts?`)&&await Promise.all(n.map(t=>O(t)));break}f([]),await b()}catch(t){x(t.message||"Batch operation failed")}finally{E(!1)}},Y=s=>{f(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},Z=()=>{const s=R(),t=s.every(a=>n.includes(a.id));f(t?a=>a.filter(r=>!s.map(se=>se.id).includes(r)):a=>[...new Set([...a,...s.map(r=>r.id)])])},R=()=>{const s=(j-1)*A;return S.slice(s,s+A)},y=Math.ceil(S.length/A),T=R(),H=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ee=s=>{const t={[c.PUBLISHED]:"success",[c.DRAFT]:"secondary",[c.ARCHIVED]:"warning"};return e.jsx(ne,{bg:t[s]||"secondary",children:s})},z={backgroundColor:I?"#2d3748":"#fff",borderColor:I?"#4a5568":"#dee2e6"};return e.jsxs(te,{fluid:!0,style:{maxWidth:"1400px",padding:"2rem 1rem"},children:[e.jsx(P,{className:"mb-4",children:e.jsx(u,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Blog Dashboard"}),e.jsx("p",{className:"text-muted mb-0",children:"Manage your blog posts and content"})]}),e.jsxs(o,{variant:"primary",onClick:()=>g("/editor/new"),children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"New Post"]})]})})}),L&&e.jsx($,{variant:"danger",onClose:()=>x(""),dismissible:!0,children:L}),e.jsx(P,{className:"mb-4",children:e.jsx(u,{children:e.jsx(C,{style:z,children:e.jsx(C.Body,{children:e.jsxs(P,{className:"g-3",children:[e.jsx(u,{md:3,children:e.jsxs(v.Select,{value:d,onChange:s=>q(s.target.value),children:[e.jsx("option",{value:"all",children:"All Posts"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"draft",children:"Drafts"}),e.jsx("option",{value:"archived",children:"Archived"})]})}),e.jsx(u,{md:3,children:e.jsx(v.Control,{type:"text",placeholder:"Filter by author",value:h==="all"?"":h,onChange:s=>J(s.target.value||"all")})}),n.length>0&&e.jsx(u,{md:6,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsxs("span",{className:"text-muted",children:[n.length," selected"]}),e.jsxs(ae,{children:[e.jsx(o,{variant:"outline-success",size:"sm",onClick:()=>B("publish"),disabled:k,children:"Publish"}),e.jsx(o,{variant:"outline-warning",size:"sm",onClick:()=>B("unpublish"),disabled:k,children:"Unpublish"}),e.jsx(o,{variant:"outline-danger",size:"sm",onClick:()=>B("delete"),disabled:k,children:"Delete"})]})]})})]})})})})}),e.jsx(P,{children:e.jsx(u,{children:e.jsx(C,{style:z,children:e.jsx(C.Body,{children:W?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading posts..."})]}):S.length===0?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("h5",{children:"No posts found"}),e.jsx("p",{className:"text-muted",children:"Create your first post to get started!"}),e.jsx(o,{variant:"primary",onClick:()=>g("/editor/new"),children:"Create Post"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(le,{responsive:!0,hover:!0,className:"mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"50px"},children:e.jsx(v.Check,{type:"checkbox",checked:T.length>0&&T.every(s=>n.includes(s.id)),onChange:Z})}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:T.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(v.Check,{type:"checkbox",checked:n.includes(s.id),onChange:()=>Y(s.id)})}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("strong",{children:s.title}),s.subtitle&&e.jsx("div",{className:"text-muted small",children:s.subtitle})]})}),e.jsx("td",{children:ee(s.status)}),e.jsx("td",{children:s.author||"Unknown"}),e.jsx("td",{children:H(s.createdAt)}),e.jsx("td",{children:H(s.updatedAt)}),e.jsx("td",{children:e.jsxs(i,{children:[e.jsx(i.Toggle,{variant:"outline-secondary",size:"sm",children:"Actions"}),e.jsxs(i.Menu,{children:[e.jsx(i.Item,{onClick:()=>g(`/blog/${s.slug||s.id}`),children:"View"}),e.jsx(i.Item,{onClick:()=>g(`/editor/${s.id}`),children:"Edit"}),e.jsx(i.Divider,{}),s.status===c.PUBLISHED?e.jsx(i.Item,{onClick:()=>M(s.id,c.DRAFT),children:"Unpublish"}):e.jsx(i.Item,{onClick:()=>M(s.id,c.PUBLISHED),children:"Publish"}),e.jsx(i.Divider,{}),e.jsx(i.Item,{className:"text-danger",onClick:()=>{U(s),p(!0)},children:"Delete"})]})]})})]},s.id))})]}),y>1&&e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsxs(w,{children:[e.jsx(w.Prev,{disabled:j===1,onClick:()=>N(s=>Math.max(1,s-1))}),[...Array(y)].map((s,t)=>e.jsx(w.Item,{active:j===t+1,onClick:()=>N(t+1),children:t+1},t+1)),e.jsx(w.Next,{disabled:j===y,onClick:()=>N(s=>Math.min(y,s+1))})]})})]})})})})}),e.jsxs(m,{show:K,onHide:()=>p(!1),children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx(m.Title,{children:"Confirm Delete"})}),e.jsx(m.Body,{children:D&&e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this post?"}),e.jsx("p",{children:e.jsxs("strong",{children:['"',D.title,'"']})}),e.jsx($,{variant:"warning",children:"This action cannot be undone."})]})}),e.jsxs(m.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>p(!1),children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:()=>X(D?.id),children:"Delete Post"})]})]})]})}const ye=re(he);export{ye as default};
