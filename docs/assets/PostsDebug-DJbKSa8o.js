import{j as e}from"./vendor-bootstrap-Dg_DQlAt.js";import{r as d,L as c}from"./vendor-router-DblBPfa5.js";import{h as k,f as A,j as g,l as x}from"./vendor-firebase-CynBMA2D.js";import{d as h}from"./auth-CXpiOxRP.js";import{T as S}from"./blog-ZFWPbi0U.js";import"./vendor-react-Bzgz95E1.js";function B(){const[i,b]=d.useState([]),[f,u]=d.useState(!0),[o,l]=d.useState(null),{theme:j}=d.useContext(S),r=j==="dark";d.useEffect(()=>{a()},[]);const a=async()=>{try{u(!0);const s=await k(A(h,"posts")),t=[];s.forEach(n=>{t.push({id:n.id,...n.data(),publishedAt:n.data().publishedAt?.toDate?.()||n.data().publishedAt,updatedAt:n.data().updatedAt?.toDate?.()||n.data().updatedAt})}),b(t)}catch(s){console.error("Error fetching posts:",s)}finally{u(!1)}},m=async s=>{try{l(s);const t=g(h,"posts",s);await x(t,{isPublished:!0}),await a(),alert("Post published successfully!")}catch(t){console.error("Error publishing post:",t),alert("Error publishing post: "+t.message)}finally{l(null)}},y=async s=>{try{l(s);const t=g(h,"posts",s);await x(t,{isPublished:!1}),await a(),alert("Post unpublished successfully!")}catch(t){console.error("Error unpublishing post:",t),alert("Error unpublishing post: "+t.message)}finally{l(null)}};if(f)return e.jsxs("div",{style:{maxWidth:800,padding:"1rem",color:r?"#e9ecef":"#212529"},children:[e.jsx("h1",{children:"Posts Debug"}),e.jsx("p",{children:"Loading posts..."})]});const P={maxWidth:800,padding:"1rem",color:r?"#e9ecef":"#212529"},C=s=>({border:`1px solid ${r?"#495057":"#ddd"}`,borderRadius:4,padding:16,marginBottom:16,backgroundColor:r?s?"#1a4a2e":"#4a1e1e":s?"#d4edda":"#f8d7da",color:r?"#e9ecef":"#212529"}),p=(s,t)=>({backgroundColor:s==="danger"?"#dc3545":r?"#198754":"#28a745",color:"white",padding:"8px 16px",border:"none",borderRadius:4,opacity:t?.6:1,cursor:t?"not-allowed":"pointer"}),D={marginTop:24,padding:16,backgroundColor:r?"#343a40":"#f8f9fa",border:`1px solid ${r?"#495057":"#dee2e6"}`,borderRadius:4,color:r?"#e9ecef":"#212529"};return e.jsxs("div",{style:P,children:[e.jsxs("h1",{children:["Posts Debug (",i.length," total posts)"]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(c,{to:"/",children:"← Back to Home"})," |",e.jsx(c,{to:"/admin/setup",style:{marginLeft:8},children:"Quick Setup"})]}),i.length===0?e.jsxs("div",{children:[e.jsx("p",{children:"No posts found in database."}),e.jsx(c,{to:"/admin/setup",children:"Create some sample posts"})]}):e.jsx("div",{children:i.map(s=>e.jsxs("div",{style:C(s.isPublished),children:[e.jsx("h3",{children:s.title}),e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Published:"})," ",s.isPublished?"✅ Yes":"❌ No"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Category:"})," ",s.category]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Author:"})," ",s.author]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",s.publishedAt?s.publishedAt.toString():"No date"]}),e.jsx("div",{style:{marginTop:12},children:s.isPublished?e.jsx("button",{onClick:()=>y(s.id),disabled:o===s.id,style:p("danger",o===s.id),children:o===s.id?"Updating...":"Unpublish"}):e.jsx("button",{onClick:()=>m(s.id),disabled:o===s.id,style:p("success",o===s.id),children:o===s.id?"Publishing...":"Publish"})})]},s.id))}),e.jsxs("div",{style:D,children:[e.jsx("h3",{children:"Debug Info:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total posts in database:"})," ",i.length]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Published posts:"})," ",i.filter(s=>s.isPublished).length]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Draft posts:"})," ",i.filter(s=>!s.isPublished).length]})]})]})}export{B as default};
