import{j as e,b as ee,R as b,c as u,a as o,A as z,C as v,F as C,g as se,h as te,D as i,P as w,M as m,B as ae}from"./vendor-bootstrap-C6xIMti8.js";import{u as ne,r as n}from"./vendor-router-DArSVHJ3.js";import{k as le,T as ie,u as re,g as ce,P as c,l as $,i as O,p as V}from"./blog-B2gm80zW.js";import"./vendor-firebase-CYcY3q11.js";import"./auth-Sw-QPVcd.js";import"./vendor-react-Bzgz95E1.js";function de(){const g=ne(),[S,_]=n.useState([]),[G,F]=n.useState(!0),[L,x]=n.useState(""),[d,W]=n.useState("all"),[h,q]=n.useState("all"),[l,f]=n.useState([]),[J,p]=n.useState(!1),[k,M]=n.useState(null),[D,U]=n.useState(!1),[j,N]=n.useState(1),[A]=n.useState(10),[oe,he]=n.useState(!1),{theme:ue}=n.useContext(ie);re(),n.useEffect(()=>{P()},[d,h,j]);const P=async()=>{try{F(!0);const t=await ce(100,{status:d==="all"?"all":d==="published"?"published-only":d==="draft"?"drafts-only":"all"});let a=t;h!=="all"&&(a=t.filter(r=>r.authorId===h||r.author&&r.author.toLowerCase().includes(h.toLowerCase()))),d!=="all"&&(a=a.filter(r=>r.status===d)),_(a)}catch(s){x(s.message||"Failed to load posts")}finally{F(!1)}},E=async(s,t)=>{try{t===c.PUBLISHED?await V(s):t===c.DRAFT&&await O(s),await P()}catch(a){x(a.message||"Failed to update post status")}},K=async s=>{try{await $(s),p(!1),M(null),await P()}catch(t){x(t.message||"Failed to delete post")}},B=async s=>{if(l.length!==0)try{switch(U(!0),s){case"publish":await Promise.all(l.map(t=>V(t)));break;case"unpublish":await Promise.all(l.map(t=>O(t)));break;case"delete":window.confirm(`Delete ${l.length} posts?`)&&await Promise.all(l.map(t=>$(t)));break}f([]),await P()}catch(t){x(t.message||"Batch operation failed")}finally{U(!1)}},Q=s=>{f(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},X=()=>{const s=I(),t=s.every(a=>l.includes(a.id));f(t?a=>a.filter(r=>!s.map(Z=>Z.id).includes(r)):a=>[...new Set([...a,...s.map(r=>r.id)])])},I=()=>{const s=(j-1)*A;return S.slice(s,s+A)},y=Math.ceil(S.length/A),T=I(),R=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Y=s=>{const t={[c.PUBLISHED]:"success",[c.DRAFT]:"secondary",[c.ARCHIVED]:"warning"};return e.jsx(ae,{bg:t[s]||"secondary",children:s})},H={};return e.jsxs(ee,{fluid:!0,style:{maxWidth:"1400px",padding:"2rem 1rem"},children:[e.jsx(b,{className:"mb-4",children:e.jsx(u,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Post Management"}),e.jsx("p",{className:"text-muted mb-0",children:"Manage your posts and content"})]}),e.jsxs(o,{variant:"primary",onClick:()=>g("/editor/new"),children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"New Post"]})]})})}),L&&e.jsx(z,{variant:"danger",onClose:()=>x(""),dismissible:!0,children:L}),e.jsx(b,{className:"mb-4",children:e.jsx(u,{children:e.jsx(v,{style:H,children:e.jsx(v.Body,{children:e.jsxs(b,{className:"g-3",children:[e.jsx(u,{md:3,children:e.jsxs(C.Select,{value:d,onChange:s=>W(s.target.value),children:[e.jsx("option",{value:"all",children:"All Posts"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"draft",children:"Drafts"}),e.jsx("option",{value:"archived",children:"Archived"})]})}),e.jsx(u,{md:3,children:e.jsx(C.Control,{type:"text",placeholder:"Filter by author",value:h==="all"?"":h,onChange:s=>q(s.target.value||"all")})}),l.length>0&&e.jsx(u,{md:6,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsxs("span",{className:"text-muted",children:[l.length," selected"]}),e.jsxs(se,{children:[e.jsx(o,{variant:"outline-success",size:"sm",onClick:()=>B("publish"),disabled:D,children:"Publish"}),e.jsx(o,{variant:"outline-warning",size:"sm",onClick:()=>B("unpublish"),disabled:D,children:"Unpublish"}),e.jsx(o,{variant:"outline-danger",size:"sm",onClick:()=>B("delete"),disabled:D,children:"Delete"})]})]})})]})})})})}),e.jsx(b,{children:e.jsx(u,{children:e.jsx(v,{style:H,children:e.jsx(v.Body,{children:G?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading posts..."})]}):S.length===0?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("h5",{children:"No posts found"}),e.jsx("p",{className:"text-muted",children:"Create your first post to get started!"}),e.jsx(o,{variant:"primary",onClick:()=>g("/editor/new"),children:"Create Post"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(te,{responsive:!0,hover:!0,className:"mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"50px"},children:e.jsx(C.Check,{type:"checkbox",checked:T.length>0&&T.every(s=>l.includes(s.id)),onChange:X})}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:T.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(C.Check,{type:"checkbox",checked:l.includes(s.id),onChange:()=>Q(s.id)})}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("strong",{children:s.title}),s.subtitle&&e.jsx("div",{className:"text-muted small",children:s.subtitle})]})}),e.jsx("td",{children:Y(s.status)}),e.jsx("td",{children:s.author||"Unknown"}),e.jsx("td",{children:R(s.createdAt)}),e.jsx("td",{children:R(s.updatedAt)}),e.jsx("td",{children:e.jsxs(i,{children:[e.jsx(i.Toggle,{variant:"outline-secondary",size:"sm",children:"Actions"}),e.jsxs(i.Menu,{children:[e.jsx(i.Item,{onClick:()=>g(`/blog/${s.slug||s.id}`),children:"View"}),e.jsx(i.Item,{onClick:()=>g(`/editor/${s.id}`),children:"Edit"}),e.jsx(i.Divider,{}),s.status===c.PUBLISHED?e.jsx(i.Item,{onClick:()=>E(s.id,c.DRAFT),children:"Unpublish"}):e.jsx(i.Item,{onClick:()=>E(s.id,c.PUBLISHED),children:"Publish"}),e.jsx(i.Divider,{}),e.jsx(i.Item,{className:"text-danger",onClick:()=>{M(s),p(!0)},children:"Delete"})]})]})})]},s.id))})]}),y>1&&e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsxs(w,{children:[e.jsx(w.Prev,{disabled:j===1,onClick:()=>N(s=>Math.max(1,s-1))}),[...Array(y)].map((s,t)=>e.jsx(w.Item,{active:j===t+1,onClick:()=>N(t+1),children:t+1},t+1)),e.jsx(w.Next,{disabled:j===y,onClick:()=>N(s=>Math.min(y,s+1))})]})})]})})})})}),e.jsxs(m,{show:J,onHide:()=>p(!1),children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx(m.Title,{children:"Confirm Delete"})}),e.jsx(m.Body,{children:k&&e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this post?"}),e.jsx("p",{children:e.jsxs("strong",{children:['"',k.title,'"']})}),e.jsx(z,{variant:"warning",children:"This action cannot be undone."})]})}),e.jsxs(m.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>p(!1),children:"Cancel"}),e.jsx(o,{variant:"danger",onClick:()=>K(k?.id),children:"Delete Post"})]})]})]})}const Pe=le(de);export{Pe as default};
